package utils

import (
	"math/big"
	"testing"
)

func TestIsInt(t *testing.T) {
	if !IsInt("12345") {
		t.Errorf("12345 wasnt classified as an Int!\n")
	}

	if IsInt("abcd") {
		t.Errorf("abcd was classified as an Int!\n")
	}

	if IsInt("!@#$^*(*)") {
		t.Errorf("Special characters were an Int!\n")
	}
}

func TestSolveforD(t *testing.T) {
	p := big.NewInt(54311)
	q, _ := new(big.Int).SetString("158304142767773473275973624083670689370769915077762416888835511454118432478825486829242855992134819928313346652550326171670356302948444602468194484069516892927291240140200374848857608566129161693687407393820501709299228594296583862100570595789385365606706350802643746830710894411204232176703046334374939501731", 10)
	d, _ := new(big.Int).SetString("3202366961024225437401042327051546624286493666159185825709910141194793831730434297613156506897776947041469725191935860984079125187288357316861055577066775317547410806245642105103224133266085961352228593400306599829530729406090559213905092312407885703344866519615905603338057992843115227254119045112779823038562373",10)
	e := 65537

	testD := SolveforD(p, q, e)

	if testD.Cmp(d) != 0 {
		t.Errorf("SolveforD resolves a different d. Got %d want %d\n", testD, d)
	}
}
